<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>AI Pronunciation Trainer</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>

  <link rel="stylesheet" href="/static/css/shared.css"/>
  <link rel="stylesheet" href="/static/css/main.css"/>
</head>

<body>

  <!-- â”€â”€ Loading overlay â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div class="loading-overlay" id="loadingOverlay" aria-live="polite">
    <div class="loading-spinner"></div>
    <div class="loading-text" id="loadingText">Processing audio...</div>
  </div>

  <!-- â”€â”€ Header â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <header class="app-header" role="banner">
    <div class="header-logo">
      <div class="logo-icon">ðŸŽ¤</div>
      <h1 class="app-title">Pronunciation Trainer</h1>
    </div>

    <!-- Live status badge -->
    <div id="main_title">Click Next to begin</div>

    <div class="header-spacer"></div>

    <!-- Session streak pill -->
    <div class="score-pill">
      Streak <span id="section_accuracy">0</span>
    </div>

    <!-- Language dropdown -->
    <div class="lang-dropdown">
      <button class="lang-btn" aria-haspopup="true" aria-expanded="false">
        <span id="languageBox">English</span>
        <span class="material-icons">expand_more</span>
      </button>
      <div class="lang-menu" role="menu">
        <a href="javascript:changeLanguage('en',true)" role="menuitem">ðŸ‡¬ðŸ‡§ English</a>
        <a href="javascript:changeLanguage('hi',true)" role="menuitem">ðŸ‡®ðŸ‡³ Hindi</a>
        <a href="javascript:changeLanguage('mr',true)" role="menuitem">ðŸ‡®ðŸ‡³ Marathi</a>
      </div>
    </div>

    <!-- Dashboard link -->
    <a href="/dashboard" class="nav-link" title="View your pronunciation dashboard">
      <span class="material-icons">dashboard</span>
      Dashboard
    </a>

    <!-- History toggle (visible on mobile) -->
    <button class="history-toggle" onclick="toggleHistoryPanel()" aria-label="Session history" title="Session history">
      <span class="material-icons">history</span>
      <span class="history-badge" id="historyBadge">0</span>
    </button>

    <!-- Theme toggle -->
    <button class="theme-toggle" onclick="toggleDarkMode()" aria-label="Toggle theme" title="Toggle dark/light mode">
      <span class="material-icons" id="themeIcon">dark_mode</span>
    </button>
  </header>

  <!-- â”€â”€ App body â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div class="app-body">

    <!-- Main practice area -->
    <main class="main-content" role="main">

      <!-- Sentence display card -->
      <div class="sentence-card" role="region" aria-label="Sentence display">
        <div class="sentence-label">Target Sentence</div>

        <p id="original_script" aria-label="Sentence to pronounce">
          Click <strong>Next</strong> to get your first sentence, then press the mic to record your pronunciation.
        </p>

        <div class="ipa-row">
          <div class="ipa-block">
            <span class="ipa-tag ref">REF</span>
            <p id="ipa_script">â€” IPA phonetic transcription will appear here â€”</p>
          </div>
          <div class="ipa-block">
            <span class="ipa-tag you">YOU</span>
            <p id="recorded_ipa_script">â€”</p>
          </div>
        </div>
      </div>

      <!-- Score ring + mic visualizer + word IPA -->
      <div class="bottom-grid">

        <div class="score-section">
          <div class="score-ring-wrap">
            <svg class="score-ring" viewBox="0 0 90 90" aria-label="Accuracy score">
              <circle class="ring-bg"   cx="45" cy="45" r="40"/>
              <circle class="ring-fill" cx="45" cy="45" r="40" id="scoreRingFill"/>
              <text class="ring-text" x="45" y="45" id="scoreRingText">â€”</text>
            </svg>
          </div>
          <div class="score-label">Accuracy</div>
          <div id="pronunciation_accuracy"></div>
        </div>

        <div class="viz-section">
          <span class="viz-label">Mic Level</span>
          <canvas id="micVisualizer" aria-label="Microphone level visualizer"></canvas>
        </div>

        <div class="word-ipa-card">
          <div class="word-ipa-title">Hover Word</div>
          <div id="single_word_ipa_pair">REF | SPOKEN</div>
        </div>

      </div>

      <!-- Playback & record controls -->
      <div class="controls-card" role="toolbar" aria-label="Playback and recording controls">
        <a id="playSampleAudio" href="javascript:playAudio()" class="btn-round disabled"
           aria-label="Play sample audio" title="Play sample">
          <span class="material-icons">play_arrow</span>
        </a>

        <a id="playRecordedAudio" href="javascript:playRecording()" class="btn-round disabled"
           aria-label="Play my recording" title="Play your recording">
          <span class="material-icons">record_voice_over</span>
        </a>

        <div class="controls-divider"></div>

        <a id="recordAudio" href="javascript:updateRecordingState()" class="btn-mic disabled"
           aria-label="Record pronunciation" aria-pressed="false" title="Record">
          <span class="material-icons" id="recordIcon">mic</span>
        </a>

        <div class="controls-spacer"></div>
      </div>

      <!-- Difficulty selector + Next button -->
      <div class="bottom-controls">
        <div class="difficulty-tabs" role="radiogroup" aria-label="Difficulty">
          <input class="diff-tab" type="radio" id="lengthCat1" name="length" value="random"/>
          <label class="diff-label" for="lengthCat1">Random</label>

          <input class="diff-tab" type="radio" id="lengthCat2" name="length" value="easy" checked/>
          <label class="diff-label" for="lengthCat2">Easy</label>

          <input class="diff-tab" type="radio" id="lengthCat3" name="length" value="medium"/>
          <label class="diff-label" for="lengthCat3">Medium</label>

          <input class="diff-tab" type="radio" id="lengthCat4" name="length" value="hard"/>
          <label class="diff-label" for="lengthCat4">Hard</label>
        </div>

        <button id="buttonNext" class="btn-next" onclick="javascript:getNextSample()" aria-label="Next sentence">
          <span class="material-icons">arrow_forward</span>
          Next
        </button>
      </div>

    </main>

    <!-- Session history sidebar (hidden on mobile) -->
    <aside class="history-sidebar" id="historySidebar" aria-label="Session history">
      <div class="history-panel">
        <div class="history-header">
          <span class="material-icons">history</span>
          <span class="history-header-text">Session History</span>
          <span class="history-avg" id="historyAvg"></span>
        </div>
        <div id="historyList">
          <div class="history-empty">
            Complete a sentence to see your history here.<br><br>
            Each attempt is tracked with its pronunciation score.
          </div>
        </div>
      </div>
    </aside>

  </div><!-- /.app-body -->

  <!-- jQuery (kept for callbacks.js compatibility) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" defer></script>
  <script src="/static/javascript/callbacks.js" defer></script>

  <noscript>
    <p style="padding:24px;color:#ef4444;">JavaScript is required for this app.</p>
  </noscript>

</body>
</html>